<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
  <title>MapSearch</title>
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt"
    crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.1/css/bulma.min.css">
  <link rel="stylesheet" href="./index.css">
  <link rel="stylesheet" href="./main.css">
  <link rel="stylesheet" href="./yb.css">
  <link rel="stylesheet" href="./ybMapView.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <style>
    /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */

    #map {
      height: 100%;
    }

    /* Optional: Makes the sample page fill the window. */

    html,
    body {
      height: 100%;
      margin: 0;
      padding: 0;
    }
  </style>
</head>

<body>

  <div class="nav__bar">
    <div class="navbar__top yb_flex_align">
      <div class="is-size-4">지도</div>
    </div>
  </div>
  <a href="./main.html">
    <img class="navigation__icon" src="./images/nav/001.png" alt="">
  </a>



  <div class="container">
    <a class="mylocation-btn button">
      <i class="fas fa-map-marker-alt"></i>
    </a>
  </div>

  <div class="buffer"></div>

  <div id="map" style="width:100%;height:80vh;margin: 20px auto"></div>

  <script>
    function initMap() {
      var zomm = 13;
      var map = new google.maps.Map(document.getElementById('map'), {
        zoom: zomm,
        center: { lat: 37.5172164, lng: 127.0474972 }
      });
      navigator.geolocation.getCurrentPosition(
        function (position) {
          var pos = {
            lat: position.coords.latitude,
            lng: position.coords.longitude
          };

          infoWindow.setPosition(pos);
          infoWindow.setContent("My Location");
          infoWindow.open(map);
          // map.setCenter(pos);
          const mylocationFindEl = document.querySelector('.mylocation-btn')
          mylocationFindEl.addEventListener('click', e => {
            mylocationFindEl.classList.add('is-loading');
            console.log('clicked!!!')
            setTimeout(function () {
              mylocationFindEl.classList.remove('is-loading')
              map.setCenter(pos);
              map.setZoom(16);
            }, 2000);

          })
        },
        function () {
          handleLocationError(true, infoWindow, map.getCenter());
        }
      );
      // Create an array of alphabetical characters used to label the markers.
      var labels = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';

      // Add some markers to the map.
      // Note: The code uses the JavaScript Array.prototype.map() method to
      // create an array of markers based on a given "locations" array.
      // The map() method here has nothing to do with the Google Maps API.
      var markers = locations.map(function (location, i) {
        return new google.maps.Marker({
          position: location,
          label: labels[i % labels.length],
        });
      });
      var contentString = [
        ['<div class="iw_inner">',
          '   <h3>더 키즈카페 강남점</h3>',
          '   <p>4.3    | 65m<br />',
          '       299개 | 카페 &gt; 키즈카페<br />',
          '       <a href="http://www.seoul.go.kr" target="_blank">www.seoul.go.kr/</a>',
          '   </p>',
          '</div>'].join(''),
        [
          '<div class="iw_inner">',
          '   <h3>맛있다 소고기</h3>',
          '   <p>4.9    | 74m<br />',
          '       178개 | 음식점 &gt; 한식<br />',
          '       <a href="http://www.seoul.go.kr" target="_blank">www.seoul.go.kr/</a>',
          '   </p>',
          '</div>'
        ].join('')
      ];

      var infoWindow = new google.maps.InfoWindow();


      var infowindow = new google.maps.InfoWindow({
        content: contentString[Math.floor(Math.random() * 2)]
      })
      markers.forEach((marker, index) => {

        marker.addListener('click', e => {
          infowindow.getMap() ? infowindow.close() : infowindow.open(map, marker)
          map.setCenter(marker.getPosition());
        })
      });



      // Add a marker clusterer to manage the markers.
      var markerCluster = new MarkerClusterer(map, markers,
        { imagePath: 'https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m' });
    }
    var locations = [
      { lat: 37.515992, lng: 127.028997 },
      { lat: 37.515992, lng: 127.027789 },
      { lat: 37.515992, lng: 127.023845 },
      { lat: 37.516992, lng: 127.025545 },
      { lat: 37.514992, lng: 127.023314 },
      { lat: 37.514992, lng: 127.028814 },
      { lat: 37.514992, lng: 127.018914 },
      { lat: 37.514992, lng: 127.019014 },
      { lat: 37.514992, lng: 127.019014 },
      { lat: 37.514992, lng: 127.021014 },
      { lat: 37.514992, lng: 127.022014 },
      { lat: 37.515992, lng: 127.023014 },
      { lat: 37.516992, lng: 127.024014 },
      { lat: 37.517992, lng: 127.025014 },
      { lat: 37.5071424, lng: 127.0436205 },
      { lat: 37.5034161, lng: 127.0497075 },
      { lat: 37.4996349, lng: 127.0415031 },
      { lat: 37.502365, lng: 127.0577782 },
      { lat: 37.5163311, lng: 127.0330725 },
      { lat: 37.5108592, lng: 127.0351886 },
      { lat: 37.5047382, lng: 127.0373083 },
      { lat: 37.5032822, lng: 127.0337874 },
      { lat: 37.520848, lng: 127.0449041 },
      { lat: 37.4964956, lng: 127.0316576 },
      { lat: 37.5238297, lng: 127.0421338 },
      { lat: 37.5201645, lng: 127.0453248 },
      { lat: 37.5143155, lng: 127.0431877 },
      { lat: 37.5108699, lng: 127.028816 },
      { lat: 37.520959, lng: 127.027304 },
      { lat: 37.5064862, lng: 127.0511555 },
      { lat: 37.5037846, lng: 127.0518052 },
      { lat: 37.5037084, lng: 127.0413516 },
      { lat: 37.5023203, lng: 127.0460213 },
      { lat: 37.5026801, lng: 127.0552965 },
      { lat: 37.5031325, lng: 127.0324398 },
      { lat: 37.5091879, lng: 127.0319947 },
      { lat: 37.5116799, lng: 127.0422534 },
    ]

  </script>
  <script src="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/markerclusterer.js">
  </script>
  <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCNftD8Z16wjeCtjsf2rw4kpTcv0Wbmo4g&callback=initMap">
  </script>
</body>